<div ng-controller="TierCtrl">
    <pre>todo: filter or search by subunit/year; localstorage; fix trick view; load idlz imgs properly</pre>
    <pre>pag: {{pag.pageItems[0].length|json}}</pre>
    <div class="panel panel-default" bs-loading-overlay>
        <div class="panel-heading" ng-init="collapse=false" ng-click="collapse = !collapse">Filters</div>
        <div class="panel-body" uib-collapse="collapse">
            <div class="col-sm-6 col-md-4">Server:<br>
                <div class="btn-group btn-group-justified">
                    <label class="btn btn-primary btn-sm" ng-model="filters.server" ng-click="filterCards()" uib-btn-radio="'jp'">Japan</label>
                    <label class="btn btn-primary btn-sm" ng-model="filters.server" ng-click="filterCards()" uib-btn-radio="'en'">Global</label>
                </div>
            </div>
            <div class="col-sm-6 col-md-4">Rarity<br>
                <div class="btn-group btn-group-justified">
                    <label class="btn btn-primary btn-sm" ng-model="filters.sr" ng-click="toggleBool(filters.sr);filterCards()" uib-btn-checkbox>SR</label>
                    <label class="btn btn-primary btn-sm" ng-model="filters.ssr" ng-click="toggleBool(filters.ssr);filterCards()" uib-btn-checkbox>SSR</label>
                    <label class="btn btn-primary btn-sm" ng-model="filters.ur" ng-click="toggleBool(filters.ur);filterCards()" uib-btn-checkbox>UR</label>
                </div>
            </div>
            <div class="col-sm-6 col-md-4">Attribute<br>
                <div class="btn-group btn-group-justified">
                    <label class="btn btn-primary btn-sm" ng-model="filters.attribute" ng-click="filterCards()" uib-btn-radio="'all'">All</label>
                    <label class="btn btn-primary btn-sm" ng-model="filters.attribute" ng-click="filterCards()" uib-btn-radio="'smile'">Smile</label>
                    <label class="btn btn-primary btn-sm" ng-model="filters.attribute" ng-click="filterCards()" uib-btn-radio="'pure'">Pure</label>
                    <label class="btn btn-primary btn-sm" ng-model="filters.attribute" ng-click="filterCards()" uib-btn-radio="'cool'">Cool</label>
                </div>
            </div>

            <div class="col-sm-6 col-md-4">Origin<br>
                <div class="btn-group btn-group-justified">
                    <label class="btn btn-primary btn-sm" ng-model="filters.premium" ng-click="toggleBool(filters.premium);filterCards()" uib-btn-checkbox>Premium</label>
                    <label class="btn btn-primary btn-sm" ng-model="filters.event" ng-click="toggleBool(filters.event);filterCards()" uib-btn-checkbox>Event</label>
                    <label class="btn btn-primary btn-sm" ng-model="filters.promo" ng-click="toggleBool(filters.promo);filterCards()" uib-btn-checkbox>Promo</label>
                </div>
            </div>
            <div class="col-sm-6 col-md-4">Idol Group<br>
                <div class="btn-group btn-group-justified">
                    <label class="btn btn-primary btn-sm" ng-model="filters.muse" ng-click="toggleBool(filters.muse);filterCards()" uib-btn-checkbox>Muse</label>
                    <label class="btn btn-primary btn-sm" ng-model="filters.aqours" ng-click="toggleBool(filters.aqours);filterCards()" uib-btn-checkbox>Aqours</label>
                </div>
            </div>
            <div class="col-sm-6 col-md-4">Skill<br>
                <div class="btn-group btn-group-justified">
                    <label class="btn btn-primary btn-sm" ng-model="filters.compare" ng-click="compareType();filterCards()" uib-btn-radio="'sc'">Scorers</label>
                    <label class="btn btn-primary btn-sm" ng-model="filters.compare" ng-click="compareType();filterCards()" uib-btn-radio="'pl'">Perfect Locks</label>
                    <label class="btn btn-primary btn-sm" ng-model="filters.compare" ng-click="compareType();filterCards()" uib-btn-radio="'hl'">Healers</label>
                </div>
            </div>

            <div class="col-sm-6 col-md-4">Idolized?<br>
                <div class="btn-group btn-group-justified">

                    <label class="btn btn-primary btn-sm" ng-model="filters.idlz" ng-click="toggleIdlz()" uib-btn-radio="false">Unidolized</label>
                    <label class="btn btn-primary btn-sm" ng-model="filters.idlz" ng-click="toggleIdlz()" uib-btn-radio="true">Idolized</label>
                </div>
            </div>
        </div>
    </div>

    <div class="input-group">
        <span class="input-group-addon">
            <i class="glyphicon glyphicon-search"></i>
        </span>
        <input type="text" class="form-control" ng-model="search" placeholder="search by card name" uib-typeahead="state for state in Typehead | filter:$viewValue | limitTo:8">
    </div>

    <table class="table table-striped">
        <thead>
            <tr>
                <th ng-click="sortBy('ID')">ID</th>
                <th>Card Name</th>
                <th ng-click="sortBy('ID')">Smile</th>
                <th ng-click="sortBy('ID')">Pure</th>
                <th ng-click="sortBy('ID')">Cool</th>
                <th ng-click="sortBy('ID')">C-Score</th>
                <th ng-click="sortBy('ID')">O-Score</th>
                <th ng-click="sortBy('ID')"ng-show="filters.compare=='sc'">Score Up</th>
                <th ng-click="sortBy('ID')" ng-show="filters.compare=='sc'">SU w/ SIS</th>
                <th ng-click="sortBy('ID')" ng-show="filters.compare=='pl'">PL Time</th>
                <th ng-click="sortBy('ID')" ng-show="filters.compare=='pl'">SIS Bonus</th>
                <th ng-click="sortBy('ID')" ng-show="filters.compare=='hl'">Avg. Heal</th>
            </tr>
        </thead>

        <tbody>
            <tr ng-repeat="card in pag.pageItems[pag.curr] | filter:search">
                <td>{{card.id}}</td>
                <td>{{card.full_name}}</td>
                <td ng-show="filters.idlz">
                  {{card.idolized_maximum_statistics_smile}}
                </td>
                <td ng-show="!filters.idlz">
                  {{card.non_idolized_maximum_statistics_smile}}
                </td>
                <td ng-show="filters.idlz">
                  {{card.idolized_maximum_statistics_pure}}
                </td>
                <td ng-show="!filters.idlz">
                  {{card.non_idolized_maximum_statistics_pure}}
                </td>
                <td ng-show="filters.idlz">
                  {{card.idolized_maximum_statistics_cool}}
                </td>
                <td ng-show="!filters.idlz">
                  {{card.non_idolized_maximum_statistics_cool}}
                </td>
                <td ng-show="filters.idlz">
                  {{card.cScore_idlz}}
                </td>
                <td ng-show="!filters.idlz">
                  {{card.cScore}}
                </td>
                <td ng-show="filters.idlz">
                  {{card.oScore_idlz}}
                </td>
                <td ng-show="!filters.idlz">
                  {{card.oScore}}
                </td>
                <td ng-show="filters.compare=='sc'">
                  {{card.skill.su |number:2}}
                </td>
                <td ng-show="filters.compare=='sc'">
                  {{card.skill.su_sis |number:2}}
                </td>
                <td ng-show="filters.compare=='pl'">
                    {{card.skill.pl |number:2}}
                </td>
                <td ng-show="filters.compare=='pl' && filters.idlz">
                    {{card.skill.pl_sis_idlz |number:2}}
                </td>
                <td ng-show="filters.compare=='pl' && !filters.idlz">
                    {{card.skill.pl_sis |number:2}}
                </td>
                <td ng-show="filters.compare=='hl'">
                  {{card.skill.hl | number:2}}
                </td>
            </tr>
        </tbody>
    </table>
    <center>
        <ul uib-pagination total-items="cards.length" items-per-page="pag.perPage" ng-model="pag.curr" class="pagination" max-size=3 boundary-link-numbers="true" rotate="true"></ul>
    </center>

    <pre>card[0] details: {{cards[0]|json}}</pre>
